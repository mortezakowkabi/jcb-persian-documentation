Ok if those of you who have Fur not already Watch this How to use the field type So the file fuel type To upload a A file If you haven't watched this Then How to dress is your first come and watch The Sartorialist Cause a lot of things But I explain it here Words I'm not gonna go into that depth Again Otherwise it Is it gonna be 2 hours But in this tutorial I'm going to the sort of the Talk about a Dragon Drop Automated Crop Functionality Which could also be used instead of this Implementation So this implementation would be I said it's more Limited You could do a crop With this one as well But we haven't Actually demonstrated that we going to demonstrate it now In this tutorial And The library I'm going to use before I Your enemy just I'll actually add a link to this video Underneath The one that you're watching Ok So The other thing you need to know about is you like it Of course I suppose by now You're very wealthy like it You like it has a very nice File uploading front-end Which I have used quite often So I am gonna demonstrate using UI kits upload But If you know anything about JavaScript and that kind of stuff It wouldn't be hard to Plug-in Bootstraps or Any other library which You actually wanna use JCB Can be scaled To be using other libraries it is go to libraries in Set up the new library and then in your Include the files in your admin View And there you go so At this point I'm just gonna use JCP sorry I like it now I'm gonna use the older version to you I get in my Presentation And that's simply because that's the one I've already got going in some of my projects I'm lazy or the reluctant Two actually Embrace the later release Because of his lack of compatibility backward compatibility Which is to me like Not not good Ok anyway let me Grant about that So where you wanna go You would like to go to get Uikit Version 2 And actually it to components This is where you would like to actually go Then You will see Sorry You'll see there is a Upload at the very bottom That actually explains too How to use this This library This is the JavaScript that will be using So it's got a nice progress bar and everything Up And This is the HTML Ruby using And it's got a nice You know Drag and drop area And selecting area So you can Dim sum Information here to the user As well as heaven drop the file right there And it works very well I've used it for Number of years now It's got some some Eventsair And it's very similar to Version 3 So if you wanted to see version freeze option you'd simply click on version 3.2 Station And scroll Summer to the bottom it says download And here it is Select Where is the market for the select And then the Dragon Drop there is the markup for the Dragon Drop so YouTube This And then this Jarvis So it's look very much the same as the few changes course Little bit changes in the Rosebud For the most part it's generally the same kind of approach so you would naturally just be able to plug-in this Instead you wanna use you I can 3 Or any other library You gonna see me making for example this dynamic And The euro is going to be done I make And weather is going to be allowing multiple or only one all those kind of I see I think the previous one and had the multiple option But this one also has allowed You know what what What type of image of file do you want to permit to be uploaded And the action is where the URL is right And yeah so you'll see me actually make some of this dynamic With the script that I'm using And of course here we are talking Ajax Oh so you are able to upload the File without saving The item Weather for this area is available And you simply can use a note Two actually At this Script to your page So that's what I usually do I use a note and just add this Somebody drop something here it's gonna post to the server And so if the item has ID I passed the ID So that it gets stored in the database immediately I'm sorry even if you save it Don't save the file actually gets added to that item And if it's a new item which means no ID we actually add a hidden field To the farm So we return the actual value that must go to the database And we put it in that hidden field So did when you then do save the item It actually does I store it in the other correct place So that's sort of the approach I'm gonna demonstrate that to you Step-by-step With an existing component which I really I got out there and which Not using And it is actually available In JCB so you'll see there is a new import JCB packages You could either click on this Or you can go to Joomla components and click on import components Is the same is really the same thing Tango go back to his dashboard And click on import HP packages There has been a release fix I think it was beIN The previous release if you clicked on import a submit package is it actually didn't Yeah I didn't give you this doesn't give you This Package tab here It gave you only those In fact it's still broken So best that go to gym along components And Ensure to click on Import components Then to be sure that it gives you this VDM packages tab This video and packages tab is in new extension on the import of components It's actually the only Part of the import of the components that already does Actual validation on the package integrity So for each of these packages that I hear we actually do have a validation Conserve giving your example how the world is not Already Free come here will See how the world isn't here So If I was 2 now Select hello world Click get package Roxy wetsuits from get up And it has a method of actually Getting a hash a checksum Of the package Now you can make sure that Elzhi hear that the validation so now this boy in the package On your server Now you can click cancel and that will delete the package from your server But This year tells you that the validation is pass so what is The actual package that we are distributing is the one you've now got And you can verify that By click on this link to click on this link It should open a simple A text ring Ok and this text string Should be the same As long as You see here That is sort of just a heads up and said area which we now We started adding song Caltex on validation And yeah it's not military grade but it's Fair enough I think I anyone trying to NOW stand in the middle of this He's gonna have Quite crazy gymnastics too To take care of Ok so at this point we The package is being imported this Displayed here and you just click Quiet means that You don't see all of the things it's doing I would suggest you Say now you wanna see everything Force update Means that if it finds a similar field type or a similar field or a similar atmosphere View anything that is similar And the creation date Is Younger in your system It actually Overrides it Because you're forced it if it If it finds it and the actual current date in your system Is older So that the one you importing is younger it all matic Lee updated With the latest Newest version This is how it works And that's why we telling you to make backups Because well the other advantages if you get to field type that was overwritten And it's not really what you expected You actually got history you can go back one step Usually would Ok So I'm gonna say yes force that and then continue And that simply adds Whole list of What it's done What is imported And it also moved an image shows you that Tells you done Ok so there we go hello world is Is now in the system Now We are going to look at something completely different And it is actually The Document manager is it paid Is a paid package Wedge We distribute You can obviously by this package From us It actually does have all this functionality you that I'm going to demonstrate now In it and so I'm just gonna use that can I add a key here and quick Continue And then basically install this component In JCB And then from there we will start demonstrating it's functionality Ok so we got document manager now installed here Let me quickly show you how Locks in action So I'm gonna install it to this component to my website And they must rate it Ok Now We have a deer component manager Sorry document manager We can create a document quite easily By clicking your document and you'll see that there is some allowed image formats are not set in the global settings please Notify assistant at Straighter So you can't disappoint upload Actually anything The image is not the documents neither any media So we'll go out of this and in the options of the component there is actually A media tab That says what type of documents you wanna allow So For our purpose I'm just gonna say PDF now with the media I'm just MP3 Hand with the images just take a Now with The images I know in Mike This component I'm only having one image and I wanted to be a specific dimension So I'm gonna say I want the word To be 200 And the heights Tubidy 300se makers C50 So it's almost like a book A four kind of Dimensions I'm so that's gonna Be used Crop my Image I'm using a library which l Show you in a moment which gets these values To decide upon how to act Actually go ahead Cropping It's an image Obviously if it's any of these it doesn't do anything only if it's an image Does it actually use the crop mechanism And it doesn't y on Ajax ok so we've done that 7 close If we now Again click on new documents We see this Dragon Drop area Like We are looked here I get help Sorry on Get a UI kit We see this thing in action really so we see it says that your Upload your image and it tells you Dad This is the What did the mentions should be And if not the doc will be cropped to this size So that means if it's not this Dimension it will be cropped that I the light enlarged or Uno downsize By dropping the file here or selecting a file from your computer And formats allowed JPG So it tells you what formats are allowed This is all Done Basically to dynamically through this Script role show you the moment Then the same goes here with the document it tells your PDF is allowed and where the media tells you MP3 Now the image I'm only allowing one image Words with the documents I'm allowing multiple Comments and multiple media for one document How this displays in works on the front end Works lovely no problems I'm going to demonstrate that that's not what this is all about I'm just Just gonna demonstrate Dysfunctionality of uploading a file And you need to you know if you use this in your own car Component you will need to extend that and use it and make it more functional as a As it should Should be in your Component Ok So now let's go and look at the code Very which we need to focus on first is basically the document Area of course We'll have to Look at somebody's fieldset attached here Some of its JavaScript And The Ajax area which is really where everything Things happening I shall see I'm using custom Go placeholders Most everywhere Because I'm re using a lot of the scripts Everywhere on other components And I've stayed for Adapted it so that it could be used multiple places So you'll see you're also of God upload file remove file Functions And it's got target and Type and field filename target Flash Type Values All these values play a role within the behaviour that we will eventually have Ordered be demonstrated On a pay well I didn't demos Strated I just Showed you how it is I will actually demonstrate it You also see here I've got this set a vast deaf mod Which is basically A function The generator For some variables Which this case is called VDM Which gets placed in a Terrible Call was Def mod This formation Is what is used to identify the view From which the query is made This is a long string which really is related to the cash At that stage Of The View ID and name This is how I passed the view name and ID So I do not really pass it by other The Ajax query I actually have it in Session memory And only if these keys valid they does it Actually work I'm sort of another layer And another layer this many layers in this to To try and make this secure Then this admin kit 2 is where I am actually loading All the Uikit Files So I am manually adding it to the View the admin backend Doesn't actually work as the site views where We could select A Library in a dynamically Ok answer to the view on compilation you have to manually add it to the view and you'll do it basic Sickly in the cust Script of the document Now I can show you some of these Snippets And then Then we can take it further There's obviously in the custom door buttons area This is the get VDM for the metallic Explain Again we have some custom script here And that's basically all that we have there And then into JavaScript area we again have set file Part of the scripted will have to look at And you see I'm using set file here Here and I'm here because we have an image We have Documents And we have media And they all Using the set file Method Which is the JavaScript Function Which is declared in this custom Script and here at the bottom of the footer We got What is known as get file Snippet which again deals with actual some of the automated integration Of the file when Drag and drop And that it actually made it Plays On the page this this takes care of that Ok so We'll go at look at those individual Concepts We also going to see like I said previously Some notes So here is the Main media uploader note There is the main document upload the note and there is the document image uploader Goodnight And so this is where I've added the HTML For the drag and drop that you see in the air Admin View Then we have for each of those correspondingly a hidden View value For the document image key Main document Documents Skip and a Main media key All of these are hidden Fields Which Basically is where we store These values Under That's really We'll look at some of that as well Ok So Let's go and see the code that is used Baby let's start in the Right So let's first look at one of these I'm uploading Concepts But since I know what's happening there I am already aware that The actual code is not there So it's actually also custom Placeholder submit so before we actually dive in let me Anyway Open the customer code area and go back into documents So that when we see the code Snip it We can actually go and Look at the code snippet Let's use this document uploader Note And open that So here we have the document uploaded note Basically we have a diff All the way down there Which has an ID And then it has the Class for the placeholder Some icons And you'll see Try again have here upload your document They're here I've got a span tag That says main documents formats so it's basically gone Be the place we load the formats with JavaScript And Then select the file from your computer is So this is all basically It's this Newport Just with a little bit of extra Flavour That's really all we looking at And then obviously there are some conventions Like main documents uploader That again here Upload drop main documents Nelson when is which if we go over the code Eventually you'll see that those conventions is what really makes this Usable then in the script area I added a JavaScript View footer And a JavaScript I'm using Is this you I get file uploader custom code so let's look at that then First We can just search for it There it is we can open that so this is the code that gets added So it's got a little bit of beer BHP here And it is saying ok great Argument 0 Formats so we are asking we getting the global parameters Of the formats reset Which remember I showed you we said it in the global settings so here we are saying document is the First Parameter passing So we are basically saying document formats here So we getting the document format and then Here we have part 2 and art one progress bar So if you think about the ID here It is progress bar The 2nd hour Which is the third argument Is Maine Document sister Second argument sorry the first argument because we counting from 0 so it's actually saying Main document So if you look back at our thing here is his main documents Formats So this is all part Of Main Documents It is the way we Identify the progress bar to progress bar and see The progress bar Uranus Progress bar main documents so it's an ID There's only one of them on the page So it's targeting it here saying ok that's the progress bar we gonna And Then Is having some settings the settings obviously the action We using J router now this J router is a little JavaScript Trick that I wrote because of an x You have this Side view or are the admin View You have it in the back end And you have it in the front end And so this is this just takes care of whether it's a backend or front-end call So that it actually executes correct Now that is your component name The argument one again would be the second argument Which is in our case Documents So basically there it says documents the type and then this the third argument which is showing as a sec Second one is Main So it's passing the target is made Rose true it has the token and there is our key Which is being used to identify the view ok so it's making a query On this This area here And it said dynamic Then over here We know that the formats must be Added to this area with pipe fitter in it It's like you remember here It adds the formats were With a pipe So we're just basically exploding the array we got here from the global parameters For documents And it is play City In here Then again we have other This actual snippet I will add under this name on a GitHub gist So you could actually copy paste it from there and adapted for your purpose Begin here We are also Imploding the formats because he wanted this play it I want to show the use of the formats So we have you Second argument or sorry Third argument and The second argument format which would be Documents and Main so if we look at our d'oeuvres We see there the formats is Documents main format is targeting this span tag And basically adding it in there Ok so that is Adding the formats HTML to this ID Then if We've detected up here That you didn't have any for maths set We basically gonna update the whole Turf Which is the upload drop area worth allowed formats are not set in a global setting Notify system that Best rated So that's the final part of our JavaScript so we have JavaScript next in with H2 Gmail Taking care of Someone do this Play and I'll behaviour on that page Ok so that is the reusable snap it So I'm re using this same snippet fileuploader For various areas So If we were to close out here And I was then to actually open the media Note You'll see that it's really just using the same snap it so if it goes the script it's the same snippet I'm just changing the variables I'm passing here is saying media media Main Where's the other one was saying document documents plural and Main This one is saying medium medium a And then The same goes with the with the image The image we also have That kind of behaviour Say you are cute image upload this one is not using the file uploader Is using the image of load which is a little different There is an image Uploader and Les images uploader in my custom Snippets I'll show you Why there are difference One allows one image And the other one allows More Wait him I'm over file one Allows one A more than one this one only allows one So it has a little bit of a different flavour and behaviour And yes I will also Should place this out there get For you to have a look at Always remember these arguments are Behaving the similar way as an array Which means that the first argument will always be zero the second argument one and so forth So I'm basically using arguments in And this slip it every where where I declare it I am actually passing There are three arguments that is required use this plus there to pass And the Death of History looks very similar except that it now would say images And Images Either using different placeholders So you need to update those accordingly As it's needed So that's just to set up the field Set up the field you need to have that JavaScript in place and you need to have that diff Sort of in place Regarding the hidden if I was to take one of the hidden Fields let's say the documents Hidden field you see there is some naming conventions here that is quite the I need to follow So it says main documents it doesn't do say documents And you'll see when we actually add the value back to the page Were able to targeted based on these naming conventions so yeah that's Quite important and then for some security Which It's really just a little extra layer I like the guy one guy said you know it's not that we can Really stop that we can just make it very hard So there are different encryption option this medium encryption local file Is actually better than the basic the basic stores the the the key in the database Which in that case means that if somebody sweeped your database it they actually do have the key But it could happen that they were able to get hold of your database but not actually all of your files Specially those that are behind the public repository so the medium encryption option can actually generator File behind the public folder which therefore is not publicly accessible And That makes it just that little bit more difficult to actually get a key to open The value And the reason is let's say your documents are You know not available to every group on your system maybe to some groups can access that document then the This is another layer of security that's already my default built into the fuel behaviour Ok So that is Really just looking at the fields now the admin view documents have some Custom script in it as well So we got to hear the set file which really is the JavaScript that Why is the The weather Gets the request back from from from the Ajax call You'll see me show you if we go back Here Here on autocomplete which Are all complete sorry there is a function And then At some point when everything is satisfied and has you set file key And it passes a bunch of variables to it Does really this is really the function That we're gonna have to look at So Let's say let's who's that set files as And insert it here So here we go So we'll see here there is a set file key function In the Document And That's what's being so in your Ajax which you using UI kits Uno function It has an auto complete So even if you look here Sony auto complete or complete which is a place where there when you know the server restore It's done everything is good then you can do some house cleaning in the browser And that's really what we doing We're taking you know if it's done We take away the progress bar we if it has an arrow we actually Pop out there is an alert if it's successful because we decide what this responds you going B So we decided to give a successful Value in the array then we fire the set file key Which is actually I'm looking at our Admin View We're adding this custom code in here and it is actually adding all the score that See here Is being added Squad a lot of code But it's all being added To the admin of you and it can be used for different admin views If it's obviously dealing with either images documents or media so I'm gonna try Try and explain all this looks almost end up teaching you some JavaScript Hello I'm being accused of writing telescope like b2b yeah sorry Ok.is The JavaScript here actually does some taking and validating in and I'll put this is Well I'll just put it out there and Really when it discovers that everything is fine the file actually was added Then it You know goes ahead Yeah it's checking the length of the filename see if the filename length is not Not greater than 20 Or if the Sorry and if it's not an image or a document Then it must be removed So the return values are here quite key To make sure that there We have this week Move file from server Functioning place Am I so due in the at View that we've got these Remove file tasks And the methods well this basically is going to force Scroll down a bit Here Here it is It's basically Querying that Remove And it's passing all the necessary variables To remove the correct file Yeah it's also checking That a person who is trying to remove the files actually logged in user and on the file Where will late when the moment we are look at the actual PHP which will again Validate that that user actually has permission to remove The file So there are all these checks and balances across the piano every step of the this implementation And I see you bye now I might realise this implementation is far more complicated then The one where you know the normal file upload that simple this really gets into them Nitty gritty of some of these things because you wanna give a real easy sort of Behaviour for your user But that will mean that you need to do way more To sort of thing for them and protect them So they don't Actually become vulnerable at any time Ok so Once we satisfied that the file is correct and it doesn't need to To be removed We actually Trigger A few Things which actually puts the file In the page That's really what we wanna Eventually end up doing Set file Is what We are moving To Wards Because we want to make sure Diet The file now after you've dragged and dropped it on the page Boom it shows in the page once it's really on the server And that's really what's Being done here a little bit It's doing a little bit of checking just to make sure we're all good Everything's fine And we end up with what we now called File name And it get past here And now We are moving Into set file And the sent file is gonna take the the target And it's going to Determine What kind of target it is Get the format get to this get that that So we can build the file name correctly And now I've got some functions here Which maybe not what you need But I mean You look through this And you decide what Keeping what is Throughout But we end up building a notice Which actually has You know You're so so happy Set And Then It Triggers The get file The get file is At the other function Which if you look at the admin View Let's go back here JavaScript We've got you the set far And here we've got the get far The get file is it getting another layer of validation and also just like Ensure that everything Is really Behaving as we would want in Spect it to behave So the rest of the snip it here is just a remove file and is Jason's String we also have a look Supper to check if If it's just ring Empty So part of just Sanitizing and validating Making sure everything Is the way we expect Ok so That's Will now wanna look at the gets filed as Which Has different Implementation and as you can see It is in the footer view footer so we have ph Speed In that area of the JavaScript So is this set and this is They get file In the get file We have a Again and Link That was a code Which we are now gonna use to actually load To make it that it can be downloaded Now that's really there should If it's a document or if it's a media We obviously don't wanna display it but we wanna have you be able to To download it So we have different behaviours for image and M Images As well as if you Scroll down for Documents at 4 media So it has different behaviours it continues building Buttons and displays And Pop this code also out there on the gates And you can look at it And See if you can make sense out of it This thing here the document link Order document button Is The potential idea about this If we go to actually Close out here And go to the actual document manager In the document manager when you create a document You have hear what I what we call description So if you add a document you can actually use those Place holders In the description And It's the beginning of Actually using these documents Across the website And not just in the component So we all eventually right little plugin And if you actually use This place holder which Generates If if you use that Anywhere The plugin Will identify at And will load either a link or a button Depending on which one you using This is the bottom this is the link That's really what it's doing So You might say I don't need placeholders and you Crap that Parton Take it out Also then we ever The bar placeholder Tom is being used in You need to remove Four example of There Because we got a file box that Building And it's basically getting the place holders The download and a delete button All of them get loaded into To the file box And If we are having more than one file We are treating And really that is what we do here being the document All different Behaviour but somewhat the same And That is what actually then does the final stretch Slikour name Erase one carries it this far and then the other one takes it over Carousel further And this one is at the very last end of the match Where it is now finally putting the in Back into the page And All of the nice little Frozen bells and whistles happen And of course this is where you can really Spice It Up JavaScript And And you can see how I'm I'm using you I get to Actually with Ok So Now you've seen The Front-end As we would call it Of the behaviour of HR Dragon Drop So you've seen how I set up the field You've seen how When the Ajax has finished it's crew Quest It actually Runs this set file key And the set file key Then Triggers Whole bunch Which ends up Adding the The file to the page Let me demonstrate here In the In our little New document Let me demonstrate some of these function Ucansi That was off now explained exactly what it does So here I've got a bunch of images Is Justin Eric open Kind of Images So I'm just gonna grab one And dump it in And You didn't see that wait Scroll down Get that image again Put it down a little lower then we get another one Let's use this house And I'm gonna drag it there and highlights it Ben from moment it has this little uploader because we are Local network Fast But usually it's eating Uploads And then when it started says your document images set So that was built with JavaScript And there is the document Meat on display And there is now remove Click that and he'll tell me are you sure you wanted to leave this document Yes and Form-Scaff Ok so and we back at Square One As if we had nothing And it doesn't only deleted from the page it actually removed On the server As well So let's drag another one just Drager tear drop Uploads and there is all nicely cropped image Obviously crops in the centre of the Image because How does it know the house is on On the side I'm not doing that Smart Dictionary We just cropping the image And the most Sensible way Now with the uploading of a document More less the same let me just get a document Ok so we got a document here And you can Dragon Drop it in there And again it uploads it And with the upload It generates those links I told you would you could Copy And I'll put it in In the Description If you want Or you could taste it What is noteworthy here Is that the name of the document doesn't Actually get lost While The the place where documents are added Is actually in the same Older so You could add multiple documents to This document I'll just keep on stacking them Though they even have the same name It will have each one will be I think Eclectic uniquely tagged Do not be the same as the other Which means that on the server we are storing this document with Long hash Sort of added on The name Which is an extra layer of security so people If they could access the folder there at least No no what the name is in Same with the image if we were to Actually inspect the Image You'll see That that image He's got this Huge name dog image JPG Grand Island through JPG So it's no longer than that same name as As the one you uploaded It actually changes it if there is preserve the name for example in And the documents Option here So did you giving to someone the document they get what you expect But we do actually Adaptor names For security So that You can't be actually allocated On the server if for some reason Ok and so you could taste it by clicking here And it should then just Bring it up in And be available as a download Now how the download works here with the document I'm actually using a controller so if we Hovered over this Link here You see ok you can't see See that Showed you Well Maybe I'll just show you the Ok I've copy the link here now Huge because we are using Basically a very much of a Encrypted Path to the to the file Sometimes being group to the sometimes just be PHC basic 4 inch But point is we have what we see here as a task download Document so there is actually a controller called Dell download In my component And I will show you how this diet download document Concept works but You need to write that You need to To figure that one out That's sort of Onto you That's if you want people to download your Your documents If it's yours to upload images Course You don't need any of this But only when you gonna actually have it downloadable File Or media So next one we wanted to show you here It's just upload some media file Ok so here I have a bunch of audio files And I'm going to upload them What I'm going to do is I'm going to select Whole bunch of them And then upload them all at once Which is really what this uploaded can actually do So See there we go Drop it there And Can't see it yet but it's actually uploading uploading uploading And Think I need to refresh the page So let's give it a name Let's say The Document Let's say More Soon And then save this And then see ok it didn't Actually upload all of them Interesting Let me try again Ok now I've got 6 of them uploaded so I can see there are 6 documents and you can Actually download them and test them See if they are still fine Why the home The order of the home Yes We see that the documents Work outlets sorry than media is working But it's also do that with documents let's add some more document So I've got a few selective and Drag and drop them there 123 And is uploaded I need to maybe check some of the JavaScript I see you didn't add the download button here But without saving if we just refresh the page you'll see that it actually has All those documents are there Because it's really used a jacket Store them in Database And so every end of day That is the behaviour we wanted here in our component we wanted the option to upload multiple Documents to one document and multiple media files And To be able to test them in the backend if you wanted to test any of them And in even be able to remove Any of them At any time You could just click on remove and it will be removed and in the front We'll be able to use the file names and The user Would be able to identify oh ok so this is what I want And so the filenames actually get preserved While it is actually being stored Ended in the server With this Hash behind it And so We are seeing the JavaScript we looked at earlier in action it is uploading is deleting This one is actually cropping which will look at it a little more So That is seeing our Dragon Drop Options in action Now let's go look at the server side of the simpler Annotation The server side we have in the documents admin View Opening the PHP tab Got this Ajax error ID And Like a show before Youth office Lee need to set up the Ajax with this area targets the controller So in the controller it creates all these necessary script To make this Method Which is again we gonna look at inside of that Custom code Make this method available to the Ajax call There are some values that we set because every Component I used to stuff in is different and so for somewhere using images And media As the types And for some The target on Main and dark and the allowed view there's only one of you in this component that is a lie To use the app loader and that is the document view and so they get view ID Is the function With which I get the actual view name And i d And it is basically using The Session to sort of Throw That around I'm doing sure That nobody is able to tamper with That value through the front and anyway So little extra little gymnastics to make Just add another layer there Ok so we gonna look now at this PHP Ajax uploader in the custom codes area So let's just go here and then Search for it So here in the customer codes area and why I'm using custom code because I'm Reusing this At the moment it doesn't look like I'm re using it many places it only says it's used in component but this is not the Area where I'm actually doing my work this is just for tutorials I'm using a whole different developing environment Runner developing System to my website then this one so this one is just for this Explaining and This demonstrating ok so I'm reusing This code in many components And here We have format image formats that are allowed and In the system Document formats that are allowed in the system Media formats that is allowed in the system and this you can adapt to whatever you need At the end of the day It's up to you to decide what you want to Allow and what you wouldn't the reality is this is the available formats but as you remember Here where was it again I'm in the options area of all component It has a media area and there we have allowed documents allowed media formats and allowed image Format and These is Should be the same right it's would be the same list having the same values But these are what is it The custom field we created in Joomla List field and so we manually added this Do the components configuration area so if you don't know what that is Let me quickly show you So in the component Here is our component it has the Where is it there it is component config If your component doesn't show one like this hello world doesn't show a component config You can go into the component And then here in Let's see thanks settings There is this button here of great component config For this Joomla component and it's in this I'm gonna close out here I don't want to do that one of I could just show you with a doctor Manager Basically big I could use the same button in settings There it is We can actually edit or now if it hasn't have one if you can Create an ear you select fields With a custom values and the tabs in which they should Should this play and it's basically as you can see here I've selected allowed document formats list Which is just a list of The format and I obviously said it to allow multiple selection So that's how I'm doing this allowed media allowed image and allow documents and And then here's the crop document image and so you if you do not know how to create a field and how to Set radio buttons or list Then go review the videos about that I'm gonna Why not now But that's really how we deal with that and that list that list that we looked at now Now is the same list as what To see here It should be the same Because This is the allowed And that list Shows the View user what is allowed for the system So how can I Sorry notice Sorry about that Notice came up and messed up everything But I hate to start over now Anyway So this is what you you could say as available for maths and then those Dropdowns is what you as the owner of this website Where this application will run is what you will allow Ok and that this list would be the same as the one there but it also is sort of going Going to be use so that people Post a specific type As if it is allowed we're gonna able to sort of bounce this and make sure that Security wise we are safe So here's the upload file function And the upload file Stars by first getting the view ID Taking it And Then making sure that there is a view set Boss And that that view is actually part of the allowed views array so they allowed views array if you remember In our Where did I show you that Ok it's in the admin View document at mizzou Maybe this one no here it is The allowed views is documents So that's why I'm saying I'm saying that outside of the Custom code because it Depends on which component we are working in right So if it is an allowed you We then get the target And the type and we said it to Global target and global target type Then we take that this type What is the format that we are talking about so If we think about The format There is Again we go back to this one I hear it's move it closer so we know Close to each other That is the Formats that we allow the types because we want to Sort of validate that the person and who is uploading Is uploading the things we anticipate so it is setting the format with the type So if it's image it will be images If it's images it will be images If it's document lb document if it's documents it'll be document and media will be media so that's the Types And we setting that is the format type now then we using a function get package from I'm upload now if you watch the previous tutorial of using the file type uploader Then it's more or less the same kind of function So if I scroll down Get to it where is it I get package from upload so Are the differences we doing the application update and Put in the function And we are targeting files because we are passing those values in the files place Then We are seeing what is the file we are checking whether these things are allowed warning import a file Error This kind of error you'll see I'm not throwing it Tu Jo Mila I'm adding it to the error messages Error error message Because we gonna have to give it back to the view Where were you when I'm able to at this is Ajax call he did nobody will see it if we just You know I used to raise warning or something So we are actually grabbing the value in saying We done here get out of here if we still going and so you see you could go through this and Very much the same implementation than the one we've demonstrated the only difference though is our Check method is actually Hello bit more Taking that View And again validating it So we doing a 2nd layer of validation here And then checking whether this Pacific user that is now logged in has the right to actually Edit this item so it says doing some user validation And if not it removes the archive And it's really we still gonna have that remove method with little bit of the code that you saw me take out Is still left in it here In the previous two Tutorial I use some of these codes and yeah so that's really all this Same I'm not gonna go into depth if you don't understand what I've just looked at here then please go back to the The previous tutorial watch that I give you enough information so that we actually up here in our file upload Upload file here we at this point have the package And we passed the package to upload now Now move the file into place so remember we had to do that in the The previous year I'm using a function upload now and in the upload now function we We are returning and if Any error now still remains It's gonna be down here where is errors that might have a good year if this was false We would use that See that's the error message put it in error And Pass It Off and if we were having Any other issues we will do there it's been an error and will pass it out so this error handling there already Now in upload now package We are checking whether the package is actually there the package name and we're starting to From that we are building the Name X showed you or explain to you That we are using This we're preserving the filename but we are sort of hiding the filename so we Using the target the target type the file format and then this random key Now I'm not exactly sure I think all JCB helper classes comes out with this Random key so you could just use it in your component and you can decide how long this string should B and then I'm using a little place holder which is little generic placeholder BDM Hyundai Then I'm adding the actual name of the file after this placeholder so that everything before What is placeholder Is really internal my system uses this but the client uses everything they say Side And so then if it's a document We are gonna need the folder path for hidden file path so again Get folder path is a function which I wrote And I'm not gonna share that with you But you can build your own helper class function To get a pass to where you wanna put the file this is up to you I'm using a hidden file path But there is A lot of Discussion behind that If I don't pass any values I would like in this case It will most probably return a public path And which would be where the images So every documents go in a hidden area Images go public And usually because the image you wanted to load somewhere So you don't want it to be behind The root folder of your website Ok now we end up here with the full path which is the file path Sorry for this this one here The filename and the file format So that becomes the file name And this becomes The file format Now I think you will notice that at this stage The package Name Is Is really was used to build this And we stripping the file format from that package Sure That it doesn't have a file Really to ensure that this Yeah this file is stored in exactly the format we detected as and not as what do I save it Now We move The Buckets Where I get interesting To its Final Destination if something fails at this point By the Dozen We actually remove the package and we say there was an error So we just like without We not gonna worry about it If it succeeds then obviously if it's an image At this stage Image We definitely want to resize it so I've got a resize Image helper Class This is also something that you would need to write yourself Which Helps me to resize my image Time passing it some values 22 actually target the image and resize it And it really doesn't change anything with the image location Or anything like that so I don't need any value back I just need it to resize it and get it done and I don't need to know anything else Then I'm doing something Christian here To see whether the basic encryption is available in this program And Then to actually use that in Christian When I start storing the documents To the database So Here is a local file And We are checking if it's a document or a media We are going to in And Then again here we make sure that this ID value Is greater than zero because if it's still unsaved item We don't have any place in the database to add this So we could just skip this pace So if we realise ok this This file or this Upload Doesn't have an ID Then we skip this function here and we rather do if it's an image If it's a document or is it it Give me if it's a media Then we load The filename like that And We are going to pass it back 2 The View Basically taking the results See here Formats it's got a lock value Teratogen Link Soda has different behaviour for the And all bills this result array and this is what we Give them back We give them back to result rate And it gets started over here File format is added Her success gets the file name which is this value here And then we start building some other things Switch on Acer Siri Like the token link Forwarded for them Because you want to have the downloadable if Media document of its media If it's an image now we don't need any worse we can just skip that And then the key name And there we go We done Where is it it is actually a safe item We are going to update the database right now With this new target type And Target So this is where the hidden field name Remember I said to you there's some Some convention In the hidden Field name Well this is where that Convention comes into To play the hidden field name is build up from Target And target type Under these two are not correct we are going to not save this value At all And so we are building an object Which then we take And since we have validated this this is definitely I love you And this Object and this ID and then we update the database And Yes We're done We've got the File name And we are basically going to pass the filename Here Same way And return to the browser So that's the service side Of this implementation There are some things which I haven't explained Like This Encryption Sorry Resizing of the image I didn't give much Get the folder path didn't in You need to write all that up But You could make this work without knowing those things You You could Put a Hardcoded path Here is the file path And you could You know not do any Many cropping and let Let the user Make sure about The cropping That is really How I upload many of my Documents Things Obviously this is Connor Sleep improving Because I'm using the slip it across multiple Places It's very easy for me to come in here And say all this is not Ideal and Fix it And then it fix it Everywhere for every every place it's News And so there is sometimes the Need of decoupling some of these functions in some but I'm trying to The highest Rise much as I can to Do that So set filename array that's another function that you saw Here in in the upload Set filename array The Stepfather Marais is really T when you realise that the actual file Already exists So there it is there Because that means that there are other files possibly still already in the database So with The ad and basic view we actually trigger the set filename array Function To check the database For that specific Target Field get the values I decrypt them and Load new values to that And then basically Pass it back to us Where is he the item doesn't exist That means it doesn't have an ID I don't know if you remember when we Did some demonstration I was Actually adding multiple Media file that only one ended up Being remembered And that sort of the downside Of the current Implementation Is that if the ID doesn't Exist We're not able to actually keep track of So it's only when the ID exist That we are able to Actually do multiple uploads Once So I should actually Give a little bit heads up of the about that That you want to save the item You're actually really to To expand upon it And to allow Multiple upload Once So the set filename array is Is really dealing with multiple when you are having multiple so you'll see there is image And document Is when the file I'm using the The plural You tell me That it should allow multiple So if it's single or Image And document that I don't allow multiple I'm just gonna remove the old one And Anthony Done And when it is plural And we are using the set filename array And we basically building It 2 GB Multiple And then One thing I didn't Empress Desai's here Is That we actually remove the The files as well There is a remove file right There's remove file And it also at some point does a validation To take whether the user has the Permission to remove files And And then will basically remove Defile So that Also it's Also uses Is this file name But then it passes the remove Variable to it Which stand means the action is not to add but to take Away and You will see that there The action here There is the Add So behave still different So we still basically get back the array we still build an object and we still updated Database As well as Actually removing the file here Ok so all of this code I will dump on GitHub and the gifts For you to reuse as you see fit you lovely have to Adapt IT And Keep it under an open source licence That's Only requirement Ok well That if all those things line-up and are in place Going back to our Admin View Basically That needs to be there These Need to be here so you could Pause the phone And Video And just make sure that you have the same kind of Ajax Query calls option And then here I am actually Doing some opening of the files You see that I'm building but I'm called links So this is going a little Beyond Just showing it above my information and these links Eventually End up on the page So we go back 2 Our JavaScript Here Scroll down We see this get filed as Now let's Again look at that get file jsp Because You'll see the doors links Actually come in To play there Remember See here Oh I see now is not in that JavaScript Is actually down here You see that here I got a Load the links to the page document links And I'm actually adding it to a variable called document C So in the Custom script Where is it It's this one you'll see if I If I now search So I'll take this copy Hear all search You see that I'm actually using that array And saying is this Just Property there And then creating a link And so that is how we deal with some of that And it it works very well To sort of pass value Strong JavaScript 2 BHP And have it available there Ok well I know this was a lot of Things to sort of take in and I would expect you to realise that that previous implementation is So much easier But like you scene When someone actually does create a document And they Are able to so easily Just dragon Drop stuff And it just crops in It just gives your component so much easier you know for you feel to it Instead of The olds you could still do the old select But the Dragon Drop is Becoming quite popular And this implementation Really Very Very Yeah it's very nice to have And I'm sure from what I've shown you you should be able to get this going in your component I'm not really gonna give support on to this meaning that If you get stuck you on your own Because if It is really the truth that you will need to know your JavaScript you'll need to Uno Your pH Speed and you will need to know how to debug Allowed to line-up these Concepts That they old I work in Synergy together It's not gonna be So easy for meat Do that Speci since I usually do not see the code But if there isn't any of the code that I've share on Gets Which I will also put in the description below this video Even have that code has issues in it Or errors in it that the That are like ok And a big problem or something Then please do feel free to Give me a heads up over there And we'll collaborate Improve it as Necessary At the end of the day This feature is really way behind What What you really need There is a media manager in In Joomla Which is actually ideal The advantage about this way is that your user is Is never gonna interfere with other user's Stuff So if you use this concept they not ever gonna actually look on your server at a list And select stuff This is why I think people would like the Because they can upload stuff in It doesn't affect other people it doesn't make Immovable as the owner of the system Who uses the application So it is I think we better approach But like I said there is a media manager So if you go to content There is a media manager And there is a media file type Which Works very well And And can also add These kind of functionality to your component If this is a little bit too challenge Challenge for you Anyway thanks for watching I know this might again be solved such a long 2 Tutorial But I'm trying my very best to To sort of get you on your feet